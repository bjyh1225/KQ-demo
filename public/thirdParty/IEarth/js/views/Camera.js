define(["text!views/html/Camera.html","libs/common/common","libs/common/defined","libs/common/defaultValue","libs/common/defineProperties","jquery","jqueryShare","Cesium","Vue"],function(e,t,n,i,a,o,r,l,d){var s={route:"路线",control:"控制",color:"颜色",play:"播放",stop:"停止",pause:"暂停",nodes:"节点信息",no:"序号",position:"位置",time:"时间",done:"操作",addNode:"添加节点",delNode:"删除节点",exportXmlFile:"导出xml文件"};for(var m in s)s[m]=window.platformLanguage[m]?window.platformLanguage[m]:s[m];var c={viewer:void 0};function u(t){t=i(t,{}),this._viewer=i(t.viewer,null),this._parentContainer=i(t.parentContainer,"cesiumContainer"),"string"==typeof this._parentContainer&&(this._parentContainer=o("#"+this._parentContainer)),this._parentContainer.append(e),this._vm=null,this._id=l.createGuid(),this.initialize()}return u.prototype.initialize=function(){var e=this;e._viewer.scene.globe.depthTestAgainstTerrain=!0,e._vm=new d({el:".camera_module",data:{guid:e._id,titles:s,viewModel:c,canPlay:!1},methods:{play:function(){this.canPlay&&e.animationPath.play()},pause:function(){e.animationPath.pause()},stop:function(){e.animationPath.stop()},selectFile:function(t){var n=this.selectFileUrl(t);e.animationPath.fromXmlFile(n).then(function(t){(t=e.animationPath.cameraKeys).length>5&&(t.length=5),e.appendNodeTotable(t)},function(){console.log("error")}),this.canPlay=!0},getFileURL:function(e){var t=null;return null!=window.createObjectURL?t=window.createObjectURL(e):null!=window.URL?t=window.URL.createObjectURL(e):null!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t},selectFileUrl:function(e){var t=this.getFileURL(e.target.files[0]);if(t)return t},addNodesToTable:function(){var t=e.viewer.scene.camera,n={destination:l.Cartesian3.clone(t.position),orientation:new l.HeadingPitchRoll(t.heading,t.pitch,t.roll),duration:5};e.animationPath.insertCameraKeys(n);var i=e.animationPath.cameraKeys;e.appendNodeTotable(i),this.canPlay=!0},delNodes:function(){var t=e.animationPath.cameraKeys;if(e.animationPath&&t&&t.length>0){e.animationPath.delNodeFromXmlFile(t.length-1);t=e.animationPath.cameraKeys;e.appendNodeTotable(t),this.canPlay=!0}},exportXml:function(){e.animationPath.exportXmlFile()}},mounted:function(){var t=e._viewer,n=new l.AnimationPath(t);e.animationPath=n}})},u.prototype.appendNodeTotable=function(e){if(e.length>0){o(".nodesTable").empty();for(var t=e.length,n=0;n<t;n++){var i=Number(n)+1,a=l.Cartographic.fromCartesian(e[n].destination)||void 0,r="<tr><td>"+i+"</td><td>("+(180*a.longitude/Math.PI).toFixed(0)+","+(180*a.latitude/Math.PI).toFixed(0)+","+a.height.toFixed(0)+')</td><td><input class="showNumber" type="text" value='+e[n].duration+"> </td></tr>";o(".nodesTable").append(r)}}},a(u.prototype,{viewer:{get:function(){return this._viewer}},vm:{get:function(){return this._vm}}}),u});