define(["text!views/html/BaseMapTerrain.html","libs/common/common","libs/common/defined","libs/common/defaultValue","libs/common/defineProperties","jquery","Cesium","Vue","VueLazyLoad","Bootstrap","views/Container","views/Enum"],function(e,a,r,t,i,n,o,s,y,p,l,m){"use strict";window.platformLanguage||(window.platformLanguage={});var c=window.platformLanguage,g=[{name:c.baseWorldImage||"基础影像",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.SingleTileImagery,url:"./images/baseImage.png",credit:"Base Imagery",iconUrl:"./images/imageLayer/baseImage.png",selected:!0,unRemoved:!0},{name:c.tiandituSatellite||"天地图卫星图",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.TiandituImagery,mapStyle:o.TiandituMapsStyle.IMG_C,credit:c.tiandituSatellite||"天地图卫星图",iconUrl:"./images/imageLayer/tianditu-satellite.jpg"},{name:c.googleSatelliteMap||"谷歌卫星图",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.GoogleMapsImagery,maptype:"satellite",credit:"The satellite map By Google Maps",iconUrl:"./images/imageLayer/google-satellite.jpg"},{name:c.tiandituLabelForSatellite||"天地图卫图中文注记",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.TiandituImagery,mapStyle:o.TiandituMapsStyle.CIA_C,credit:c.tiandituLabelForSatellite||"天地图影像中文注记",iconUrl:"./images/imageLayer/tianditu-label-cn.jpg"},{name:c.tiandituLabelForSatelliteEN||"天地图卫图英文注记",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.TiandituImagery,mapStyle:o.TiandituMapsStyle.EIA_C,credit:c.tiandituLabelForSatelliteEN||"天地图卫星图英文注记",iconUrl:"./images/imageLayer/tianditu-label-en.jpg"},{name:c.tencentSatelliteMap||"腾讯地图卫星图",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.QQMapsImagery,maptype:"satellite",credit:c.tencentSatelliteMap||"腾讯地图卫星图",iconUrl:"./images/imageLayer/qq-satellite.jpg"},{name:c.tencentLabelMapForSatellite||"腾讯地图卫图注记",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.QQMapsImagery,maptype:"satellite_label",credit:c.tencentLabelMapForSatellite||"腾讯地图卫图注记",iconUrl:"./images/imageLayer/qq-map-label.jpg"},{name:c.tencentMap||"腾讯地图",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.QQMapsImagery,maptype:"map",credit:c.tencentMap||"腾讯地图卫星图",iconUrl:"./images/imageLayer/map-color-cn.jpg"},{name:c.tencentMapDark||"腾讯地图(暗色调)",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.QQMapsImagery,maptype:"map_dark",credit:c.tencentMapDark||"腾讯地图(暗色调)",iconUrl:"./images/imageLayer/qq-map-dark.jpg"},{name:c.mapChinaMidnightBlue||"中国地图午夜蓝版",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.ArcGISMapServerImagery,url:"https://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer",credit:c.mapChinaMidnightBlue||"中国地图午夜蓝板",iconUrl:"./images/imageLayer/map-blue.jpg"},{name:c.mapChinaColor||"中国地图彩色版",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.ArcGISMapServerImagery,url:"https://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer",credit:"ArcGIS全球国家地区矢量",iconUrl:"./images/imageLayer/map-color-cn.jpg"},{name:c.mapChinaColorEN||"中国地图彩色版英文",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.ArcGISMapServerImagery,url:"https://map.geoq.cn/arcgis/rest/services/ChinaOnlineCommunityENG/MapServer",credit:c.mapChinaColorEN||"ArcGIS全球国家地区矢量",iconUrl:"./images/imageLayer/map-color-en.jpg"},{name:c.googleMap||"谷歌地图",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.GoogleMapsImagery,maptype:"roadmap",credit:c.googleMap||"谷歌地图",iconUrl:"./images/imageLayer/google-map-color-cn.jpg"},{name:c.terrianShadingMap||"地形晕渲图",type:m.eObjectType.Imagery,dataSourceType:m.eDataSourceType.QQMapsImagery,maptype:"dem",credit:c.terrianShadingMap||"地形晕渲图",iconUrl:"./images/imageLayer/qq-map-dem.jpg"}],d=[{name:"STK World Terrain meshes",type:m.eObjectType.Terrain,dataSourceType:m.eDataSourceType.CesiumTerrain,url:"https://assets.agi.com/stk-terrain/v1/tilesets/world/tiles",requestWaterMask:!0,requestVertexNormals:!0,credit:"STK World Terrain meshes",iconUrl:"./images/imageLayer/terrain.jpg"},{name:"VR The World Terrain",type:m.eObjectType.Terrain,dataSourceType:m.eDataSourceType.VRTheWorldTerrain,url:"http://www.vr-theworld.com/vr-theworld/tiles1.0.0/73/",credit:"Terrain data courtesy VT MÄK",iconUrl:"./images/imageLayer/terrain.jpg"}],u={addNew:"新增",image:"影像",terrain:"地形"};for(var T in u)u[T]=window.platformLanguage[T]?window.platformLanguage[T]:u[T];function S(r){r=t(r,{}),this._viewer=t(r.viewer,null),this._parentContainer=t(r.parentContainer,"cesiumContainer"),this._title=t(r.title,"Panel"),this._content=t(e,""),this._shown=t(r.shown,!0),this._showHeader=t(r.showHeader,!1),this._showTitle=t(r.showTitle,!0),this._showCloseBtn=t(r.showCloseBtn,!0),this._style=t(r.style,{position:"absolute",top:"0",left:"0",margin:"0",width:"auto"}),this._bodyStyle=t(r.bodyStyle,{padding:"5px",margin:0}),this._draggable=t(r.draggable,!1),this._container=null,this._vm=null,this._id=a.newGuid(),this.initialize(r)}return S.prototype.initialize=function(e){var a=this,r=t(e.parentContainer,"cesiumContainer");this._parentContainer=t(r,""),this._viewer=t(e.viewer,null),this._style=t(e.style,void 0);var i={parentContainer:this._parentContainer,title:this._title,content:this._content,shown:this._shown,showHeader:this._showHeader,showTitle:this._showTitle,showCloseBtn:this._showCloseBtn,style:this._style,bodyStyle:this._bodyStyle,draggable:this._draggable};this._container=new l(i),s.use(y,{error:"images/imageLayer/nopicture.jpg",loading:"images/lazy-loading.gif"}),this._vm=new s({el:".module-baseMap-terrain-content",data:{guid:a._id,baseImageryLayerCollection:g,terrainLayerCollection:d,titles:u,dataType:"image"},watch:{},methods:{onTabsToggle:function(e){this.dataType=e},onAddNewBtnClk:function(e){"image"==e?alert("add new image"):alert("add new terrain")},onImageryItemsClk:function(e){a.addAndRemoveImageryLayer(e)},onTerrainItemsClk:function(e){a.addAndRemoveTerrainLayer(e)}}}),this.listenSceneObjectRemoved()},S.prototype.addAndRemoveImageryLayer=function(e){var a=this.vm.baseImageryLayerCollection[e];if(!a.unRemoved){var r=this._viewer.imageryLayers.getLayerByGuid(a.guid||"");r?(this._viewer.imageryLayers.remove(r),a.selected=!1,this.vm.$set(this.vm.baseImageryLayerCollection,e,a)):(r=this.getImageLayerByOptions(a))&&(this._viewer.imageryLayers.add(r),r.getViewableRectangle().then(function(e){}),a.guid=r.guid,a.selected=!0,this.vm.$set(this.vm.baseImageryLayerCollection,e,a))}},S.prototype.setImageLayerVisibleMask=function(e,a){if(e){var r=this._viewer.imageryLayers;a?r.indexOf(e)>-1||this._viewer.imageryLayers.add(e):e.show=!1}},S.prototype.getImageLayerByOptions=function(e){var a=void 0;switch((e=t(e,{})).dataSourceType||void 0){case m.eDataSourceType.SingleTileImagery:a=new o.SingleTileImageryProvider(e);break;case m.eDataSourceType.OverlayImagery:a=new o.OverlayImageryProvider(e);break;case m.eDataSourceType.BingMapsImagery:a=new o.BingMapsImageryProvider(e);break;case m.eDataSourceType.MapBoxImagery:a=new o.MapboxImageryProvider(e);break;case m.eDataSourceType.OpenStreetMapImagery:a=new o.createOpenStreetMapImageryProvider(e);break;case m.eDataSourceType.TileMapServiceImagery:a=new o.createTileMapServiceImageryProvider(e);break;case m.eDataSourceType.GoogleMapsImagery:a=new o.GoogleMapsImageryProvider(e);break;case m.eDataSourceType.QQMapsImagery:a=new o.QQMapsImageryProvider(e);break;case m.eDataSourceType.AMapsImagery:a=new o.AMapsImageryProvider(e);break;case m.eDataSourceType.BaiduMapsImagery:a=new o.BaiduMapsImageryProvider(e);break;case m.eDataSourceType.TiandituImagery:a=new o.TiandituImageryProvider(e);break;case m.eDataSourceType.ArcGISMapServerImagery:a=new o.ArcGisMapServerImageryProvider(e);break;case m.eDataSourceType.KQGIS3DServerImagery:a=new o.KQGISMapServerImageryProvider(e);break;case m.eDataSourceType.KQGIS3DTileFileImagery:a=new o.KQGIS3DTileFileImageryProvider(e);break;case m.eDataSourceType.KQGISMapServerImagery:a=new o.KQGIS3DServerImageryProvider(e);break;case m.eDataSourceType.WebMapServiceImagery:a=new o.WebMapServiceImageryProvider(e);break;case m.eDataSourceType.WebMapTileServiceImagery:a=new o.WebMapTileServiceImageryProvider(e)}var i=void 0;return r(a)&&(i=new o.ImageryLayer(a,{show:!0,name:e.name})),i},S.prototype.addAndRemoveTerrainLayer=function(e){var a=this.vm.terrainLayerCollection[e];if(!a.unRemoved){var r=null;if(a.selected)r=new o.EllipsoidTerrainProvider({}),this._viewer.terrainProvider=r,a.selected=!1,this.vm.$set(this.vm.terrainLayerCollection,e,a);else if(r=this.getTerrainProviderByOptions(a)){this._viewer.terrainProvider=r,a.selected=!0,this.vm.$set(this.vm.terrainLayerCollection,e,a);for(var t=0;t<this.vm.terrainLayerCollection.length;t++)if(t!=e){var i=this.vm.terrainLayerCollection[t];i.selected=!1,this.vm.$set(this.vm.terrainLayerCollection,t,i)}}}},S.prototype.getTerrainProviderByOptions=function(e){var a=void 0;switch((e=t(e,{})).dataSourceType||void 0){case m.eDataSourceType.EllipsoidTerrain:a=new o.EllipsoidTerrainProvider(e);break;case m.eDataSourceType.CesiumTerrain:a=new o.CesiumTerrainProvider(e);break;case m.eDataSourceType.GoogleEarthEnterpriseTerrain:a=new o.GoogleEarthEnterpriseTerrainProvider(e);break;case m.eDataSourceType.VRTheWorldTerrain:a=new o.VRTheWorldTerrainProvider(e);break;case m.eDataSourceType.KQGIS3DTileFileTerrain:a=new o.KQGIS3DTileFileTerrainProvider(e);break;case m.eDataSourceType.KQGIS3DServerTerrain:a=new o.KQGIS3DServerTerrainProvider(e)}return a},S.prototype.listenSceneObjectRemoved=function(){var e=this,a=this._viewer.imageryLayers,r=this._viewer.scene.primitives;a.layerRemoved.addEventListener(function(a){e.updateVMSeletedStateByGuid(a.guid,!1)},{}),r.primitiveRemoved.addEventListener(function(a){e.updateVMSeletedStateByGuid(a.guid,!1)},{})},S.prototype.updateVMSeletedStateByGuid=function(e,a){var r=this;r.vm.baseImageryLayerCollection.forEach(function(t,i){if(t.guid&&t.guid==e)return t.selected=a,void r.vm.$set(r.vm.baseImageryLayerCollection,i,t)})},i(S.prototype,{container:{get:function(){return this._container}},vm:{get:function(){return this._vm}},shown:{get:function(){return this._container.shown},set:function(e){this._container.shown=e}}}),S});