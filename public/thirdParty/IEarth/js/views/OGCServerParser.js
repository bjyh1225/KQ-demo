define(["jquery"],function(e){"use strict";var t={parseOGCWMTSCapabilities:function(t){var a="http://www.opengis.net/ows/1.1",i=(t=t.substring(0,t.toLowerCase().lastIndexOf("/wmts")+5))+"?SERVICE=WMTS&REQUEST=GetCapabilities";function n(e){if(e&&e.length>0)return e[0].innerHTML}return new Promise(function(t,r){e.ajax({url:i,type:"GET",dataType:"xml",success:function(e){var i=[],r=e.getElementsByTagName("Contents");if(r&&r.length>0){for(var g=r[0].getElementsByTagName("Layer"),l=0;l<g.length;l++){var m=g[l];if("Contents"==m.parentNode.tagName){var s={},o=m.getElementsByTagNameNS(a,"Title");s.title=n(o),s.name=s.title;var y=m.getElementsByTagNameNS(a,"Abstract");s.abstract=n(y);var u=m.getElementsByTagNameNS(a,"Identifier");s.identifier=n(u);var d=m.getElementsByTagNameNS(a,"BoundingBox");if(s.boundingBox={lowerCorner:void 0,upperCorner:void 0},d&&d.length>0){var x=d[0].getElementsByTagNameNS(a,"LowerCorner"),B=d[0].getElementsByTagNameNS(a,"UpperCorner");s.boundingBox.lowerCorner=n(x)?n(x).split(" "):void 0,s.boundingBox.upperCorner=n(B)?n(B).split(" "):void 0}s.style="default";var N=m.getElementsByTagName("Style");if(N&&N.length>0){u=N[0].getElementsByTagNameNS(a,"Identifier");s.style=n(u)}var T=m.getElementsByTagName("Format");s.format=n(T),s.tileMatrixSetLink={tileMatrixSet:"w"},s.tileMatrixSetID="w";var E=m.getElementsByTagName("TileMatrixSetLink");if(E&&E.length>0){var f=E[0].getElementsByTagName("TileMatrixSet");s.tileMatrixSetLink.tileMatrixSet=n(f),s.tileMatrixSetID=s.tileMatrixSetLink.tileMatrixSet}i.push(s)}}var h=[],v=r[0].getElementsByTagName("TileMatrixSet");for(l=0;l<v.length;l++){s={};if("Contents"==(f=v[l]).parentNode.tagName){u=f.getElementsByTagNameNS(a,"Identifier");s.identifier=n(u);var b=f.getElementsByTagNameNS(a,"SupportedCRS");s.supportedCRS=n(b),s.tileMatrixs=[],s.tileMatrixLabels=[];for(var S=f.getElementsByTagName("TileMatrix"),L=0;L<S.length;L++){var p={},M=S[L];u=M.getElementsByTagNameNS(a,"Identifier");p.identifier=n(u);var c=M.getElementsByTagName("ScaleDenominator");p.scaleDenominator=n(c);var C=M.getElementsByTagName("TopLeftCorner");p.topLeftCorner=n(C)?n(C).split(" "):void 0;var w=M.getElementsByTagName("TileWidth"),A=M.getElementsByTagName("TileHeight");p.tileWidth=n(w)?Number(n(w)):void 0,p.tileHeight=n(A)?Number(n(A)):void 0;var R=M.getElementsByTagName("MatrixWidth"),W=M.getElementsByTagName("MatrixHeight");p.matrixWidth=n(R),p.matrixHeight=n(W),p.identifier&&s.tileMatrixLabels.push(p.identifier),s.tileWidth=p.tileWidth,s.tileHeight=p.tileHeight,s.tileMatrixs.push(p)}h.push(s);var H=h.length-1;i[H]&&(i[H].tileWidth=s.tileWidth,i[H].tileHeight=s.tileHeight,i[H].tileMatrixLabels=s.tileMatrixLabels,i[H].tileMatrixLabels=s.tileMatrixLabels,i[H].tileMatrixSet=s)}}}t(i),console.log(i)},error:function(e){r([])}})})},parseOGCWMSCapabilities:function(t){var a=(t=t.substring(0,t.toLowerCase().lastIndexOf("/wms")+5))+"?SERVICE=WMS&REQUEST=GetCapabilities";function i(e){if(e&&e.length>0)return e[0].innerHTML}return new Promise(function(t,n){e.ajax({url:a,type:"GET",dataType:"xml",success:function(e){for(var a=[],n=e.getElementsByTagName("Layer"),r=0;r<n.length;r++){var g=n[r];if("Layer"===g.parentNode.tagName){var l={},m=g.getElementsByTagName("Name");l.name=i(m);var s=g.getElementsByTagName("Title");l.title=i(s);var o=g.getElementsByTagName("Abstract");l.abstract=i(o);var y=g.getElementsByTagName("KeywordList");if(l.keywordList=[],y&&y.length>0)for(var u=y[0].getElementsByTagName("Keyword"),d=0;d<u.length;d++){var x=u[d];l.keywordList.push(i(x))}var B=g.getElementsByTagName("SRS");l.srs=i(B);var N=g.getElementsByTagName("LatLonBoundingBox");l.latLonBoundingBox={},N&&N.length>0&&(l.latLonBoundingBox.minx=N[0].getAttribute("minx"),l.latLonBoundingBox.miny=N[0].getAttribute("miny"),l.latLonBoundingBox.maxx=N[0].getAttribute("maxx"),l.latLonBoundingBox.maxy=N[0].getAttribute("maxy"));var T=g.getElementsByTagName("BoundingBox");l.boundingBox={},T&&T.length>0&&(l.boundingBox.srs=T[0].getAttribute("srs"),l.boundingBox.minx=T[0].getAttribute("minx"),l.boundingBox.miny=T[0].getAttribute("miny"),l.boundingBox.maxx=T[0].getAttribute("maxx"),l.boundingBox.maxy=T[0].getAttribute("maxy")),l.style={};var E=g.getElementsByTagName("Style");if(E&&E.length>0){l.style.name=i(E[0].getElementsByTagName("Name")),l.style.title=i(E[0].getElementsByTagName("Title")),l.style.abstract=i(E[0].getElementsByTagName("Abstract")),l.style.legendURL={};var f=E[0].getElementsByTagName("LegendURL");f&&f.length>0&&(l.style.legendURL.width=f[0].getAttribute("width"),l.style.legendURL.height=f[0].getAttribute("height"),l.style.legendURL.format=i(f[0].getElementsByTagName("Format")),l.format=l.style.legendURL.format)}a.push(l)}}t(a)},error:function(e){n([])}})})}};return t});