define(["text!views/html/Tours.html","libs/common/common","config","jquery","Vue","Bootstrap","views/Container","Cesium"],function(t,e,n,o,i,s,a,r){"use strict";var l={no:"序号",tourName:"路径名称",done:"操作",play:"播放",pause:"暂停",stop:"停止"};for(var u in l)l[u]=window.platformLanguage[u]?window.platformLanguage[u]:l[u];function h(n){n=r.defaultValue(n,{}),this._viewer=r.defaultValue(n.viewer,null),this._parentContainer=r.defaultValue(n.parentContainer,"cesiumContainer"),this._title=r.defaultValue(n.title,"Panel"),this._content=r.defaultValue(t,""),this._shown=r.defaultValue(n.shown,!0),this._showHeader=r.defaultValue(n.showHeader,!1),this._showTitle=r.defaultValue(n.showTitle,!0),this._showCloseBtn=r.defaultValue(n.showCloseBtn,!0),this._style=r.defaultValue(n.style,{position:"absolute",top:"0",left:"0",margin:"0",width:"auto"}),this._bodyStyle=r.defaultValue(n.bodyStyle,{margin:0,padding:0}),this._container=null,this._vm=null,this._id=e.newGuid(),this._containerCollection={},this.tourList=[],this.initialize(n)}return h.prototype.initialize=function(t){var e=this,s={parentContainer:this._parentContainer,title:this._title,content:this._content,shown:this._shown,showHeader:this._showHeader,showTitle:this._showTitle,showCloseBtn:this._showCloseBtn,style:this._style,bodyStyle:this._bodyStyle};this._container=new a(s),this._vm=new i({el:".module-tours-content",data:{titles:l,message:"Hello Vue!",tourList:[]},created:function(){o.ajax({url:n.paths.tours,type:"GET",dataType:"json",success:function(t){e._vm.tourList=t},error:function(t){console.log(t)}})},methods:{onPlayBtnClk:function(t){e.play(t)},onStopBtnClk:function(t){e.stop(t)}}})},h.prototype.play=function(t){var e,n,o,i=this,s={duration:3};this.tourList[t]?this.tourList[t].play(i._viewer,s):(e=this._viewer,n=this._vm.tourList[t].url,o={camera:e.scene.camera,canvas:e.scene.canvas},new Promise(function(t,i){try{var s=r.KmlDataSource.load(n,o);e.dataSources.add(s).then(function(e){var n=e.kmlTours[0];t(n)})}catch(t){i(t)}})).then(function(e){i.tourList[t]=e,e.play(i._viewer,s)})},h.prototype.stop=function(){this.tourList.forEach(function(t,e){t&&t.stop()})},r.defineProperties(h.prototype,{container:{get:function(){return this._container}},vm:{get:function(){return this._vm}},shown:{get:function(){return this._container.shown},set:function(t){this._container.shown=t}}}),h});