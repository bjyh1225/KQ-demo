define(["text!views/html/SightAnalysis.html","libs/common/common","libs/common/defined","libs/common/defaultValue","libs/common/defineProperties","jquery","jqueryShare","Cesium","Vue"],function(t,i,e,n,a,s,r,o,l){var h={showLabel:"显示标注",seePoint:"添加观察点",targetPoint:"添加目标点",clearAll:"清除所有"};for(var d in h)h[d]=window.platformLanguage[d]?window.platformLanguage[d]:h[d];var g={showLabel:!0};function v(i){i=n(i,{}),this._viewer=n(i.viewer,null),this._parentContainer=n(i.parentContainer,"cesiumContainer"),"string"==typeof this._parentContainer&&(this._parentContainer=s("#"+this._parentContainer)),this._parentContainer.append(t),this._vm=null,this.sightAnalysis=new o.Kq3dSightAnalysis({viewer:this._viewer,isLabel:!1}),this.flag1=!1,this.flag2=!1,this.divPointArr=[],this.initialize(),this.addPoint()}return v.prototype.initialize=function(){var t=this;t._vm=new l({el:".sight_analysise_module",data:{guid:t._id,titles:h,sightAnalysis:g},methods:{addSeePoint:function(){t.flag1=!0},addTragetPoint:function(){t.flag2=!0},showLabel:function(i){this.sightAnalysis.showLabel=i.target.checked;for(var e=0;e<t.divPointArr.length;e++)t.divPointArr[e].setVisible(i.target.checked)},clearAll:function(){t.sightAnalysis.remove();for(var i=0;i<t.divPointArr.length;i++)t.divPointArr[i].destroy();t.divPointArr=[],t.flag1=!1,t.flag2=!1}}})},v.prototype.addPoint=function(){new o.ScreenSpaceEventHandler(this._viewer.scene.canvas).setInputAction(t=>{var i=this._viewer.scene.pickPosition(t.position);if(this.flag1&&(this.sightAnalysis.setSeePoint(i),this.flag1=!1),this.flag2){this.flag2=!1;var e=this.sightAnalysis.addTargetPoint(i);if(e&&(pickedFeatures=e.id),i){var n=o.Cartographic.fromCartesian(i),a=o.Math.toDegrees(n.longitude).toFixed(5),s=o.Math.toDegrees(n.latitude).toFixed(5),r=o.Math.toDegrees(n.height).toFixed(3),l='<div class="whiteLabel">\n                                <table>\n                                    <tr>\n                                        <td>X:</td>\n                                        <td>{X}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>Y:</td>\n                                        <td>{Y}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>Z:</td>\n                                        <td>{Z}</td>\n                                    </tr>\n                                </table>\n                                <span></span>\n                            </div>';l=l.replace("{X}",a).replace("{Y}",s).replace("{Z}",r);var h=new o.DivPoint(this._viewer,{html:l,position:i,anchor:[0,-15],noEvent:!0});this._vm.sightAnalysis.showLabel||h.setVisible(!1),this.divPointArr.push(h)}}},o.ScreenSpaceEventType.LEFT_CLICK)},a(v.prototype,{vm:{get:function(){return this._vm}}}),v});