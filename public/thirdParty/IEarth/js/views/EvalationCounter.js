define(["text!views/html/EvalationCounter.html","libs/common/common","libs/common/defined","libs/common/defaultValue","libs/common/defineProperties","jquery","jqueryShare","Cesium","Vue"],function(e,n,t,a,i,o,r,l,s){var u={evalationSpace:"等高线距值(米)",evaltionCounterWidth:"等高线宽度(px)",evaltionCounterColor:"等高线颜色",maxHeight:"最大可见高度(m)",minHeight:"最小可见高度(m)",analysist:"分析",clear:"清除"};for(var h in u)u[h]=window.platformLanguage[h]?window.platformLanguage[h]:u[h];var v={viewer:void 0,spaceing:150,lineWidth:2,evaltionCounterColor:"#d9ea32",minHeight:1e3,maxHeight:8e3,type:l.ElevationAnalyseType.SUFACE_LINE,positions:[new l.Cartesian3(0,0,0),new l.Cartesian3(1,1,1),new l.Cartesian3(2,2,2),new l.Cartesian3(3,3,3),new l.Cartesian3(4,4,4)]};function c(n){n=a(n,{}),this._viewer=a(n.viewer,null),this._parentContainer=a(n.parentContainer,"cesiumContainer"),"string"==typeof this._parentContainer&&(this._parentContainer=o("#"+this._parentContainer)),this._parentContainer.append(e),this._vm=null,this.drawHandler=void 0,this.elevationAnalyse=void 0,this.isShowToolTip=!0,this.initialize()}return c.prototype.initialize=function(){var e=this;e._vm=new s({el:".evalation_analysist_module",data:{guid:e._id,titles:u,evalationCounters:v},methods:{changeCounterWidth:function(){e.elevationAnalyse.width=Number(this.evalationCounters.lineWidth)},changeCounterSpace:function(){e.elevationAnalyse.spaceing=Number(this.evalationCounters.spaceing)},changeMaxHeight:function(){e.elevationAnalyse.maxHeight=Number(this.evalationCounters.maxHeight)},changeMinHeight:function(){e.elevationAnalyse.minHeight=Number(this.evalationCounters.minHeight)},analyse:function(){e.startlAnalyse()},clear:function(){e.elevationAnalyse.show=!1}},mounted:function(){}}),e.renderPlugins(),e.updateColorValueWithColorChange(),e.renderHandler()},c.prototype.startlAnalyse=function(){this.startDrawRegion()},c.prototype.updateColorValueWithColorChange=function(){var e=this;o("#point_label_color_"+e._vm.guid).bind("change",function(n){e._vm.evalationCounters.evaltionCounterColor=n.target.value,e.elevationAnalyse.color=l.Color.fromCssColorString(e._vm.evalationCounters.evaltionCounterColor)})},c.prototype.startDrawRegion=function(){var e=this,n=e.viewer;n.scene.globe.depthTestAgainstTerrain||(n.scene.globe.depthTestAgainstTerrain=!0),e.drawHandler.startDrawingGeometry(l.DrawMode.Polygon),e.drawHandler.drawEndEvent.addEventListener(function(n){if(n.drawMode==l.DrawMode.Polygon){var t=n.positions;e.elevationAnalyse.positions=t,e.elevationAnalyse.show=!0}})},c.prototype.updateMaterials=function(e){if(e)switch(e){case"counter":that.elevationAnalyse.type=l.ElevationAnalyseType.LINE;break;case"surface":that.elevationAnalyse.type=l.ElevationAnalyseType.SUFACE;break;case"surface_line":that.elevationAnalyse.type=l.ElevationAnalyseType.SUFACE_LINE}},c.prototype.renderPlugins=function(){o(".color-selector").each(function(){var e=this;o(e).ColorPicker({color:"#0000ff",onShow:function(e){return o(e).fadeIn(500),!1},onHide:function(e){return o(e).fadeOut(500),!1},onChange:function(n,t,a){o(e).css("backgroundColor","#"+t),e.value="#"+t,o(e).change();var i=255-a.r,r=255-a.g,l=255-a.b;o(e).css("color","rgba("+i+","+r+","+l+")"),o(e).parent().find(".caret").eq(0).css("border-top-color","rgba("+i+","+r+","+l+")");var s="rgba("+a.r+","+a.g+","+a.b+",0)",u="rgb("+a.r+", "+a.g+", "+a.b+")";o(e).parent().parent().parent().find("input[type=range]").eq(0).css("background","linear-gradient(to right, "+s+", "+u+")").css("background","-moz-linear-gradient(left, "+s+", "+u+")")}})})},c.prototype.renderHandler=function(){var e=this.viewer;this.vm.evalationCounters.viewer=e,this.elevationAnalyse=new l.ElevationAnalyse(this.vm.evalationCounters);var n=new l.DrawHandler(e,{showTooltip:this.isShowToolTip,dblClickEnd:!1});this.drawHandler=n},i(c.prototype,{viewer:{get:function(){return this._viewer}},vm:{get:function(){return this._vm}}}),c});